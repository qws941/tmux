# ~/.tmux/conf.d/00-core.conf - Terminal, performance, basics

# ── Terminal & Colors ──
set -g default-terminal "tmux-256color"
# Reset overrides first (prevents -ga accumulation on reload)
set -g terminal-overrides ""
set -g terminal-overrides ",*256col*:RGB:Smulx=\\E[4::%p1%dm:Setulc=\\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m"
set -ga terminal-overrides ",xterm*:RGB"

# ── Performance ──
set -g escape-time 0
set -g focus-events on
set -g extended-keys on
setw -g allow-passthrough on

# ── Availability (prevent accidental session loss) ──
set -g detach-on-destroy off       # When session killed, switch to another instead of detach
set -g exit-empty off              # Keep server alive even with no sessions
set -g exit-unattached off         # Keep server alive when no clients attached
set -g destroy-unattached off      # Don't kill sessions when client detaches

# ── Mosh Compatibility ──
setw -g aggressive-resize on
set -g status-interval 5

# ── Locale Propagation (CJK/Korean text rendering) ──
# Ensure locale env vars propagate on client reattach (prevents garbled Korean)
set -ga update-environment ' LANG LC_ALL LC_CTYPE'

# ── Display ──
set -g display-time 2000            # Show messages for 2s (default 750ms too short)
set -g display-panes-time 2000      # Show pane numbers for 2s

# ── Mouse ──
set -g mouse on

# ── Clipboard ──
# OSC 52 — works through mosh/SSH tunnels
set -g set-clipboard on

# ── Scrollback ──
set -g history-limit 50000

# ── Indexing ──
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
